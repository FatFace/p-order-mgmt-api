<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:munit="http://www.mulesoft.org/schema/mule/munit"
	xmlns:munit-tools="http://www.mulesoft.org/schema/mule/munit-tools" xmlns="http://www.mulesoft.org/schema/mule/core"
	xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xsi:schemaLocation="
		http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
		http://www.mulesoft.org/schema/mule/munit http://www.mulesoft.org/schema/mule/munit/current/mule-munit.xsd
		http://www.mulesoft.org/schema/mule/munit-tools  http://www.mulesoft.org/schema/mule/munit-tools/current/mule-munit-tools.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd">
	<munit:config name="order-create-impl-test-suite.xml" />
	<munit:test name="order-aptos-impl-test-suite-create-order-details-from-aptos-to-d365-main-flowTest" description="Test" doc:id="8c77df98-b9bf-44b8-85ba-055b4bdf4cf4" >
		<munit:behavior >
			<munit-tools:mock-when doc:name="Mock DB DM Lookup Http Requester" doc:id="2cbad921-f942-43cb-9dfe-2197a00a8129" processor="http:request">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute attributeName="doc:name" whereValue="Call DB DM Lookup Http Request Configuration" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:payload value='#[MunitTools::getResourceAsString("response/ordercreate-dblookup-delivery-mode-response.json")]' mediaType="application/json" />
				</munit-tools:then-return>
			</munit-tools:mock-when>
			<munit-tools:mock-when doc:name="Mock DB SO Lookup Http Requester" doc:id="eae318b5-11ca-4efe-b22f-e7fef497a46b" processor="http:request">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute attributeName="doc:name" whereValue="Call DB SO Lookup Http Request Configuration" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:payload value='#[MunitTools::getResourceAsString("response/ordercreate-dblookup-sales-origin-response.json")]' mediaType="application/json" />
				</munit-tools:then-return>
			</munit-tools:mock-when>
			<munit-tools:mock-when doc:name="Mock Shipping Barcode HTTP Requester" doc:id="7c7beb2c-8c22-4976-9d58-ed6fb5083fac" processor="http:request">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="Call DB Lookup Http Request Configuration For Shipping Barcode" attributeName="doc:name" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:payload value='#[MunitTools::getResourceAsString("response/ordercreate-dblookup-shipping-barcode-response.json")]' mediaType="application/json" />
				</munit-tools:then-return>
			</munit-tools:mock-when>
			<munit-tools:mock-when doc:name="Mock Report DB Http Requester" doc:id="02a28410-127a-49ee-b9c8-dfc4db60018b" processor="http:request">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="Call Report DB Http Request Configuration" attributeName="doc:name" />
				</munit-tools:with-attributes>
			</munit-tools:mock-when>
			<munit-tools:mock-when doc:name="Mock D365 Http Requester" doc:id="57475b8a-a591-4b83-ad73-657d412dd7d7" processor="http:request">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="Call D365 Http Request Configuration" attributeName="doc:name" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:payload value='#[MunitTools::getResourceAsString("response/ordercreate-d365-response.json")]' mediaType="application/json" />
				</munit-tools:then-return>
			</munit-tools:mock-when>
		</munit:behavior>
		<munit:execution >
			
			<set-payload value="#[MunitTools::getResourceAsString('request/order-create-valid-input-request.json')]" doc:name="Set Payload" doc:id="6cf9b2c9-46ef-48d1-9bcf-538ef15d29ce" mimeType="application/json"/>
			<flow-ref doc:name="Flow-ref to create-order-details-from-aptos-to-d365-main-flow" doc:id="61232f70-d1d7-4a0c-8baa-252057f6b820" name="post:\orders:application\json:p-order-mgmt-api-config" />
		</munit:execution>
		<munit:validation >
		
			<munit-tools:assert-that doc:name="Assert that" doc:id="a158c2e2-032c-4554-ba0c-63cb715144e9" is="#[MunitTools::equalTo('CREATED')]" expression="#[payload.responseText]"/>
			<!-- <munit-tools:assert-equals doc:name="Assert equals" doc:id="aa34b1e6-39ba-4280-a051-c5d1a55aa081" actual="#[payload]" expected='#[MunitTools::getResourceAsString("response/ordercreate-d365-response.json")]'/> -->
		</munit:validation>
	</munit:test>
<munit:test name="order-aptos-impl-test-suite-create-order-details-from-aptos-to-d365-main-flowTest-negative" description="Test" doc:id="359be190-a9bb-4b26-b352-0f325f4d442d" >
		<munit:behavior >
			<munit-tools:mock-when doc:name="Mock DB DM Lookup Http Requester" doc:id="ad342a6d-ca94-4a77-a0a4-03f2553862c4" processor="http:request">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute attributeName="doc:name" whereValue="Call DB DM Lookup Http Request Configuration" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:payload value='#[MunitTools::getResourceAsString("response/ordercreate-dblookup-delivery-mode-response.json")]' mediaType="application/json" />
				</munit-tools:then-return>
			</munit-tools:mock-when>
			<munit-tools:mock-when doc:name="Mock DB SO Lookup Http Requester" doc:id="ad06656c-9e5f-4745-99dd-2fcf8dd3c968" processor="http:request">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute attributeName="doc:name" whereValue="Call DB SO Lookup Http Request Configuration" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:payload value='#[MunitTools::getResourceAsString("response/ordercreate-dblookup-sales-origin-response.json")]' mediaType="application/json" />
				</munit-tools:then-return>
			</munit-tools:mock-when>
			<munit-tools:mock-when doc:name="Mock Shipping Barcode HTTP Requester" doc:id="f2fceaa3-7544-41c9-a2eb-332b0f380149" processor="http:request">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="Call DB Lookup Http Request Configuration For Shipping Barcode" attributeName="doc:name" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:payload value='#[MunitTools::getResourceAsString("response/ordercreate-dblookup-shipping-barcode-response.json")]' mediaType="application/json" />
				</munit-tools:then-return>
			</munit-tools:mock-when>
			<munit-tools:mock-when doc:name="Mock Report DB Http Requester" doc:id="61f4adbf-6f41-4fe9-af2b-a432c41c1491" processor="http:request">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="Call Report DB Http Request Configuration" attributeName="doc:name" />
				</munit-tools:with-attributes>
			</munit-tools:mock-when>
			<munit-tools:mock-when doc:name="Mock D365 Http Requester" doc:id="fd8d79f8-1cfd-4a5f-9e29-f80cd16be4d0" processor="http:request">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="Call D365 Http Request Configuration" attributeName="doc:name" />
				</munit-tools:with-attributes>
			</munit-tools:mock-when>
		</munit:behavior>
		<munit:execution >
			<set-payload value="#[MunitTools::getResourceAsString('request/order-create-empty-input-request.json')]" doc:name="Set Payload" doc:id="26276132-e136-47f2-9e95-4792cc021f80" mimeType="application/json"/>
			<flow-ref doc:name="Flow-ref to create-order-details-from-aptos-to-d365-main-flow" doc:id="528d060f-9245-4792-8971-ad9f4e151617" name="post:\orders:application\json:p-order-mgmt-api-config" />
		</munit:execution>
		<munit:validation >
			<munit-tools:assert-that doc:name="Assert that" doc:id="86653de9-36bd-4dd4-82d6-a7f2496b9267" is="#[MunitTools::notNullValue()]" expression="#[payload]"/>
		</munit:validation>
	</munit:test>

</mule>
